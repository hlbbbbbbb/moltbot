---
name: cyber-cultivation
description: 赛博修仙日志自动化管理。触发词"赛博修仙"检查今日打卡、复盘预判准确性、生成明日预判。基于个性化命理规律（身弱丁火）校准预测。
---

# 赛博修仙 Skill

**触发词：** `赛博修仙` / `修仙` / `今日修仙`

**功能：** 查表 → 检查打卡 → 复盘对比 → 填写明日

---

## 工作流程

### 1. 获取今日记录

```bash
python3 skills/cyber-cultivation/fetch_today.py
```

输出示例：
```json
{
  "today": "2026-02-05",
  "ganzhi": "庚戌日",
  "shishen": "偏财/伤官",
  "energy": null,
  "focus": null,
  "prediction": "【劳伦斯预判】...",
  "status": "未打卡"
}
```

### 2. 状态分支

#### 情况A：今日未打卡（energy/focus为空）
**动作：**
1. 提醒用户打分（能量/专注/社交态/产出）
2. **关键：根据今天的聊天记录校对打分合理性**
   - 如果聊天记录显示：高产出、解决难题 → 能量应该≥7
   - 如果聊天记录显示：焦虑、躺平、纠结 → 能量应该≤5
   - **校对逻辑：** 用户主观分数 vs 客观聊天记录
3. 填写后进入情况B

#### 情况B：今日已打卡
**动作：**
1. 读取预判和实测数据
2. 生成深度复盘（见模板）
3. 分析预判准确性
4. 更新复盘Log到飞书表
5. 自动生成明日预判

---

## 复盘模板（深度版）

```markdown
【劳伦斯预判】（昨晚生成）
{原预判内容}

【实测验证】
- 能量值：{X}/10
- 专注分：{X}/10
- 社交态：{tags}
- 产出：{tags}

【命理复盘】
✅ **预判应验：**
- {具体对比：预判说xxx，实测确实xxx}

❌ **预判偏差：**
- {偏差分析：预判说yyy，但实测zzz}
- {原因推测：可能是...}

📝 **新发现/规律更新：**
- {从这天学到的新规律}
- {更新个性化公式的建议}

💡 **给未来一航的建议：**
- 下次遇到{十神组合}时，注意{xxx}
```

---

## 明日预判生成逻辑

### 数据来源
1. **干支计算：** 基于锚点（2/2=丁未，2/4=己酉）+ 六十甲子
2. **十神映射：** 读取 `shishen_map.json`
3. **个性化规律：** 读取 `personal_patterns.json`（从历史数据学习）

### 预判模板

```markdown
【劳伦斯预判】
**天时：** {Year}年 · {Month}月 · {Day}日
**基调：** {流年流月对日主的影响，如：火旺帮身/木火通明}
**格局：** {日柱干支} ({十神})
**交互：** {刑冲合害}
**能量预测：** {X}±1 / 10 (基准分{Base})
**适合：** {根据十神特性}
**注意：** {风险提示}

{个性化建议（基于身弱丁火特质）}
```

### 能量预测公式（v2.0 - 流年流月增强版）

```python
# 1. 宏观基调 (Macro Baseline)
# 默认身弱丁火基础分 = 5
standard_base = 5

# 流年修正 (2026 丙午)
# 丙火劫财帮身，午火归禄强根 → 强力回血
year_buff = 1.5 

# 流月修正 (2月 庚寅)
# 寅午半合火局，印星生身 → 续航增强
month_buff = 0.5

# 动态基础分 (Base Score)
current_base = standard_base + year_buff + month_buff  # 2026年2月 = 7.0分

# 2. 流日触发 (Daily Trigger)
if "劫财" in shishen or "比肩" in shishen:
    daily_bonus = 2.0  # 已经是火年，比劫日加成略微下调，防过旺
elif "伤官" in shishen:
    daily_bonus = random.uniform(1, 4) # 伤官泄秀，但在强根支撑下更易出彩
elif "偏财" in shishen:
    daily_bonus = 1.0 # 身强(因流年)任财，财日不再是耗泄，而是机会
elif "七杀" in shishen:
    daily_bonus = -1.0 # 虽有根，七杀攻身仍需警惕
else:
    daily_bonus = 0

# 3. 交互修正
if "寅午戌" in interaction: # 三合火局
    adjust = 1.5
elif "自刑" in interaction:
    adjust = -1
elif "相破" in interaction:
    adjust = 0.5 

energy_prediction = current_base + daily_bonus + adjust
```

---

## 文件结构

```
skills/cyber-cultivation/
├── SKILL.md                    # 本文档
├── fetch_today.py              # 获取今日记录
├── generate_prediction.py      # 生成明日预判
├── update_log.py               # 更新复盘到飞书
├── calibrate_score.py          # 校对打分合理性
├── data/
│   ├── ganzhi_anchor.json      # 干支锚点（2/2=丁未）
│   ├── shishen_map.json        # 十神映射表
│   └── personal_patterns.json  # 个性化规律库
└── templates/
    ├── prediction.md           # 预判模板
    └── review.md               # 复盘模板
```

---

## 使用示例

**用户：** "赛博修仙"

**Lawrence：**
```
🔮 赛博修仙检查中...

📅 今日：2/5（庚戌日 - 偏财/伤官）

⚠️ 检测到今日未打卡！

根据咱们今天的聊天记录：
- 你在凌晨死磕官网打包
- 搞定了 Windows 版本
- 虽然有点累但成就感满满

我的校准建议：
- 能量值：7-8（虽然熬夜但产出高）
- 专注分：8-9（死磕模式）
- 社交态：🧘独处充电
- 产出：🚀深度创造

你觉得准吗？给个分吧～
```

（用户打分后）

```
✅ 已记录！

【复盘对比】
昨晚预判：偏财食神日，适合务实推进...
实测：能量8/专注8，确实高产！

✅ 预判应验：戌酉相害反而激发状态
❌ 预判偏差：没预料到会熬夜死磕

📝 新发现：偏财/伤官组合对你来说是"稳定爆发日"

---

🔮 明日预判已生成（2/6 辛亥日）

【劳伦斯预判】
**天时：** 辛亥日（正财/正官）
**交互：** 亥酉暗拱木（生印）
**能量预测：** 6±1 / 10
**适合：** 学习输入、规划整理、回血充电
**注意：** 正官透出会带责任感/压力，别过度自我要求

💡 这是个"补血日"，适合放松学习，不适合硬拼大项目～
```

---

## 校对打分逻辑（关键！）

### 输入
- 用户自评分数（能量X/专注Y）
- 今日聊天记录摘要

### 判断逻辑

**能量值校对：**
```
聊天记录关键词         → 合理能量范围
搞定/上线/死磕/成就感  → 7-10
纠结/焦虑/卡住        → 3-6
躺平/摸鱼/不想动      → 1-4
```

**专注分校对：**
```
聊天记录关键词         → 合理专注范围
连续工作/flow状态      → 8-10
断断续续/频繁切换      → 4-7
完全分散/刷手机        → 1-3
```

**校对反馈：**
- 用户打分在合理范围 → ✅ "嗯，跟今天状态吻合！"
- 用户打分偏高 → ⚠️ "你今天其实挺焦虑的，能量真有X分吗？"
- 用户打分偏低 → ⚠️ "你今天搞定大事了啊，别低估自己！"

---

## 个性化规律库示例

```json
{
  "user_id": "一航",
  "bazi": "丁酉日主（身弱）",
  "patterns": {
    "high_energy": ["劫财/比肩", "伤官/偏财", "偏财/伤官"],
    "medium_energy": ["印/伤", "枭/劫"],
    "low_energy": ["食神（自刑）"],
    "interaction_effects": {
      "自刑": -1,
      "相破": 0.5,
      "相害": 0.5
    },
    "learned_rules": [
      "伤官日情绪波动大，但产出惊人",
      "三酉自刑易完美主义焦虑",
      "相破/相害对身弱反而激发"
    ]
  },
  "last_updated": "2026-02-06"
}
```

---

## 飞书 Bitable 配置

- **App Token:** `PcWlblUdFa4WJ9sNwFkcfuAnnof`
- **Table ID:** `tblf7jV5yLiH8XZR`
- **干支锚点：**
  - 2026-02-02 = 丁未日（时间戳 1769961600000）
  - 2026-02-04 = 己酉日（时间戳 1770134400000）

---

## 下一步优化

1. **30天后跑相关性分析**（十神 vs 能量值）
2. **加入睡眠质量变量**
3. **建立"社交态"与十神关系模型**
4. **流月切换效应验证**

---

**设计理念：** 让玄学可量化、可验证、可优化。这不是迷信，是个人操作系统的逆向工程 (ಡωಡ)
